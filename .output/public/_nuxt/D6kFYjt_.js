import{j as k,k as y,r as d,u as b,a as B,f as x,e as L,h as o,t as m,q as a,s as g,v as h,x as v}from"./nQZhfqKX.js";const U={class:"auth-block"},E={class:"auth__header"},I={id:"error-message"},P={class:"password-block"},R={class:"buttons"},V=k({__name:"auth",setup(T){async function f(s){if(l.value&&r.value){if(s==="Register"&&r.value.length<6){n("Password should be at least 6 symbols length");return}if(s==="Register"&&r.value!==i.value){n("Passwords do not match");return}const t=s==="Login"?"/api/auth/login":"/api/auth/signup";try{const e=await $fetch(t,{method:"post",body:{username:l.value,password:r.value}});if((e==null?void 0:e.status)===200&&(e!=null&&e.user))localStorage.setItem("user",JSON.stringify(e.user)),_.push("main-page");else if((e==null?void 0:e.status)!==200)switch(console.error("Error:",e==null?void 0:e.status,(e==null?void 0:e.error)||"Unknown error"),e==null?void 0:e.status){case 401:n("Password is wrong");break;case 400:n("Username already exists");break;case 404:n("Username not found");break;default:n("An unexpected error occurred")}}catch(e){console.error("Fetch error:",e)}}}function p(s){f(s)}function n(s){var t,e;c.value=s,(e=(t=document.getElementById("error-message"))==null?void 0:t.classList)==null||e.add("auth__error__message")}function w(s){var e;const t=(e=document.getElementById("second-password"))==null?void 0:e.classList;s=="Login"?(u.value="Register",t==null||t.add("input__show"),t==null||t.remove("input__hidden")):(u.value="Login",t==null||t.add("input__hidden"),t==null||t.remove("input__show"))}y(async()=>{JSON.parse(localStorage.getItem("user")??"null")&&_.push("/main-page")});const l=d(""),r=d(""),i=d(""),_=b(),c=d(""),u=d("Register");return B(c,()=>{setTimeout(()=>{var s,t;(t=(s=document.getElementById("error-message"))==null?void 0:s.classList)==null||t.remove("auth__error__message"),setTimeout(()=>{c.value=""},300)},1500)}),(s,t)=>(x(),L("section",U,[o("div",E,[t[5]||(t[5]=o("h2",null,"Tic Tac Toe",-1)),o("p",I,m(a(c)),1)]),g(o("input",{type:"text",placeholder:"Username","onUpdate:modelValue":t[0]||(t[0]=e=>v(l)?l.value=e:null)},null,512),[[h,a(l)]]),o("div",P,[g(o("input",{type:"password",placeholder:"Password","onUpdate:modelValue":t[1]||(t[1]=e=>v(r)?r.value=e:null)},null,512),[[h,a(r)]]),g(o("input",{type:"password",class:"second__password",placeholder:"Confirm Password",id:"second-password","onUpdate:modelValue":t[2]||(t[2]=e=>v(i)?i.value=e:null)},null,512),[[h,a(i)]])]),o("div",R,[o("button",{onClick:t[3]||(t[3]=e=>p(a(u)))},m(a(u)),1),o("a",{onClick:t[4]||(t[4]=e=>w(a(u)))},m(a(u)!=="Login"?"I have an account":"Create account"),1)])]))}});export{V as default};
