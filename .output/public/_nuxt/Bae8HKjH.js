import{e as y,j as k,r as d,x as b,a as B,s as x,k as L,t as o,v as m,z as a,A as g,B as v,C as h,D as U}from"./B7Xbt7eH.js";const E={class:"auth-block"},I={class:"auth__header"},P={id:"error-message"},R={class:"password-block"},T={class:"buttons"},$=y({__name:"auth",setup(S){async function _(s){if(l.value&&r.value){if(s==="Register"&&r.value.length<6){u("Password should be at least 6 symbols length");return}if(s==="Register"&&r.value!==i.value){u("Passwords do not match");return}const t=s==="Login"?"/api/auth/login":"/api/auth/signup";try{const e=await $fetch(t,{method:"post",body:{username:l.value,password:r.value}});if((e==null?void 0:e.status)===200&&(e!=null&&e.user))localStorage.setItem("user",JSON.stringify(e.user)),p.push("main-page");else if((e==null?void 0:e.status)!==200)switch(console.error("Error:",e==null?void 0:e.status,(e==null?void 0:e.error)||"Unknown error"),e==null?void 0:e.status){case 401:u("Password is wrong");break;case 400:u("Username already exists");break;case 404:u("Username not found");break;default:u("An unexpected error occurred")}}catch(e){console.error("Fetch error:",e)}}}function f(s){_(s)}function u(s){var t,e;c.value=s,(e=(t=document.getElementById("error-message"))==null?void 0:t.classList)==null||e.add("auth__error__message")}function w(s){var e;const t=(e=document.getElementById("second-password"))==null?void 0:e.classList;s=="Login"?(n.value="Register",t==null||t.add("input__show"),t==null||t.remove("input__hidden")):(n.value="Login",t==null||t.add("input__hidden"),t==null||t.remove("input__show"))}k(async()=>{JSON.parse(localStorage.getItem("user")??"null")&&p.push("/main-page")});const l=d(""),r=d(""),i=d(""),p=b(),c=d(""),n=d("Register");return B(c,()=>{setTimeout(()=>{var s,t;(t=(s=document.getElementById("error-message"))==null?void 0:s.classList)==null||t.remove("auth__error__message"),setTimeout(()=>{c.value=""},300)},1500)}),(s,t)=>(x(),L("section",E,[o("div",I,[t[6]||(t[6]=o("h2",null,"Tic Tac Toe",-1)),o("p",P,m(a(c)),1)]),g(o("input",{type:"text",placeholder:"Username","onUpdate:modelValue":t[0]||(t[0]=e=>h(l)?l.value=e:null)},null,512),[[v,a(l)]]),o("div",R,[g(o("input",{type:"password",placeholder:"Password",onKeyup:t[1]||(t[1]=U(e=>f(a(n)),["enter"])),"onUpdate:modelValue":t[2]||(t[2]=e=>h(r)?r.value=e:null)},null,544),[[v,a(r)]]),g(o("input",{type:"password",class:"second__password",placeholder:"Confirm Password",id:"second-password","onUpdate:modelValue":t[3]||(t[3]=e=>h(i)?i.value=e:null)},null,512),[[v,a(i)]])]),o("div",T,[o("button",{onClick:t[4]||(t[4]=e=>f(a(n)))},m(a(n)),1),o("a",{onClick:t[5]||(t[5]=e=>w(a(n)))},m(a(n)!=="Login"?"I have an account":"Create account"),1)])]))}});export{$ as default};
